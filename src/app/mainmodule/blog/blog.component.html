<div class="container mt-4">
  <h2 class="text-center">Blogging App</h2><br>

  <div class="text-end">
    <button (click)="login()" *ngIf="!log" class="btn btn-primary m-3">Login</button>
    <button (click)="logout()" *ngIf="log" class="btn btn-primary m-3">Logout</button>
  </div>

  <div class="text-center" *ngIf="!showAlertFormOnly && !log && !result">
    <button (click)="toggleForm()" class="btn btn-primary">Add Your's</button>
   </div><br><br>
   <div class="card" *ngIf="showAlertFormOnly">
   <form [formGroup]="alertform" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label>Name:</label><br>
      <input formControlName="name" placeholder="Your Name">
    </div>
    <div class="form-group">
      <label>Memories</label>
      <ckeditor [editor]="Editor" class="form-control" formControlName="text"></ckeditor>
    </div>
    <div class="form-group">
      <label>Upload Image</label>
      <input type="file" (change)="onFileSelected($event)" accept="image/*">
    </div>
    <button (click)="closeform()" class="btn btn-danger m-3">Close</button>
    <button type="submit" class="btn btn-success m-2" [disabled]="alertform.invalid">Post</button>
  </form>
   </div><br><br>
  <form [formGroup]="loginform" *ngIf="log && !result" (ngSubmit)="checkin()" class="card container text-start">
    <div class="card-title text-center mt-2">Login Form</div>
    <div class="form-group ms-5">
      <label>User:</label><br>
      <input formControlName="user" placeholder="Please enter user name">
      <div *ngIf="loginform.controls['user'].invalid && loginform.controls['user'].touched">
        <span class="text-danger">User name required</span>
      </div>
    </div><br>
    <div class="form-group ms-5">
      <label>Password:</label><br>
      <input type="password" formControlName="pwd" placeholder="Please enter your password">
      <div *ngIf="loginform.controls['pwd'].invalid && loginform.controls['pwd'].touched">
        <span class="text-danger">Password required</span>
      </div><br><br>
      <button class="btn btn-success text-center ms-6" [disabled]="loginform.invalid">Checkin</button><br><br>
    </div>
  </form>

  <p class="alert alert-info" *ngIf="result">{{ loginform.value.user }} Logged In</p>
 
  <div
  infiniteScroll
  [infiniteScrollDistance]="2"
  [infiniteScrollThrottle]="100"
  (scrolled)="onScroll()">
  <div *ngIf="!showLoginFormOnly">
    <div *ngFor="let post of visiblePosts" class="card mb-3">
      <div class="card-body row">
        <h5 class="card-title col-md-10">User: {{ post.name }}</h5>
        <ng-container *ngIf="log && result">
          <button class="btn btn-sm btn-success col-md-1 text-center" (click)="toggleHide(post)">
            {{ post.collapsed ? 'View' : 'Hide' }}
          </button>
        </ng-container>
        <div
          *ngIf="(log && result && !post.collapsed) || (!log && !post.hide)"
          class="col-12 mt-3">
          <p class="text-muted text-end"><b>{{ post.time | date: 'dd-MM-yyyy | hh:mm:ss-a' }}</b></p>
          <h5>Caption:</h5>
          <p class="card-text" [innerHTML]="post.text"></p>
          <img *ngIf="post.image" [src]="post.image" class="img-fluid" width="200" />
        </div>
    </div>
  
        <div *ngIf="!log && post.hide">
          <h6 class="text-muted ms-4">This post is hidden</h6>
        </div>
      </div>
    </div>

 
  <div *ngIf="loading" class="text-center my-2">
      <span class="spinner-border spinner-border-sm"></span> Loading more...
    </div>
    <div *ngIf="!hasMorePosts && !loading" class="text-center text-muted my-2">
      No more posts to load.
    </div>
  </div>
  </div>
 
